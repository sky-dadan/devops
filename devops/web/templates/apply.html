{% extends "base.html" %}
{% block title %}申请发布{% endblock %}
{% block breadcrumb %}<a href="/">个人中心</a>{% endblock %}

{% block h1 %}申请发布{% endblock %}

<!--主体内容-->
{% block row %}
<div class="widget-box">
  <div class="widget-title">
	  <span class="icon"> <i class="icon-th"></i></span>
      <h5>申请发布</h5>
  </div> <!--end widget-title-->

<!--填写发布信息的模态窗-->          
<div id="applyModal" class="modal hide fade">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">发布信息</h4>
	  </div><!--modal-header end-->

      <div class="modal-body">
      <p hidden id="errorMsg" class="text-danger" style="color:red"></p> <!-- foe error msg-->
      <form class="form-horizontal" id="applyform">
         <input type="hidden" id='id' name="id">  <!--update need id-->
     	<div class="form-group">
            <label class="control-label">项目名</label>
     		 <div class="controls">
       		 	<input id="project_name"  type="text"  name="project_username">
      		</div> 
       	</div> <!--project_name end-->
     	<div class="form-group">
            <label class="control-label">发布简介</label>
     		 <div class="controls">
       		 	<input id="project_info"   type="text"  name="project_info" />
      		</div>  
       	</div> <!-- project_info  end-->
        <div class="form-group">
            <label class="control-label">发布详情</label>
      		<div class="controls">
                <textarea id="project_detail " type="text"  rows="5" name="project_detail" ></textarea>
      		</div> 
		</div><!--project_detail  end -->
    	<div class="form-group">
     		<div class="modal-footer">
                <button class="btn btn-primary" >确定</button>
                <button class="btn btn-warning" data-dismiss="modal">取消</button>
         	</div>
       </div><!--button end-->
    </form><!--form end-->
   </div> <!--modal body end-->
</div><!--modal end -->

<div class="widget-content">
   <table id ="datatable"  class="table table-bordered table-striped">
	<thead>
		<tr>
            <th scope="col">项目名</th>
            <th scope="col">最新版本</th>
            <th scope="col">申请人</th>
            <th scope="col">申请时间</th>
            <th scope="col">发布状态</th>
            <th  scope="col">操作</th>
        </tr>
	</thead>
	<tbody>
        {% if result %}
        {% for p_id,p_name in result.iteritems() %}
        <tr>
            <td style="text-align: center;">{{ p_name }}</td>
            <td style="text-align: center;">001</td>
            <td style="text-align: center;">111</td>
            <td style="text-align: center;">11</td>
            <td style="text-align: center;">11</td>
            <td style="text-align: center;">
                <button  class='btn btn-primary btn-sm applybtn' data-id='{{ p_id }}' data='{{ p_name }}'>申请发布</button>   
             </td>
        </tr>
        {% endfor %}
        {% endif %}
	</tbody>
   </table>

</div> <!--widget-content  end -->
</div> <!--widget-box end -->
{% endblock %}

{% block js %}
<script type="text/javascript" src="/static/js/jquery.dataTables.min.js"></script>
<script>
$('#datatable').DataTable({
        "language": {
            "lengthMenu": "每页 _MENU_ 条记录",
            "zeroRecords": "没有找到记录",
            "sInfo": "第 _PAGE_ 页 ( 总共 _PAGES_ 页 ),显示第 _START_ 至 _END_ 项(总共 _TOTAL_ 项)",
            "infoEmpty": "无记录",
            "infoFiltered": "(从 _MAX_ 条记录过滤)",
            "sSearch": "搜索:",
            "oPaginate": {
                "sFirst": "首页",
                "sPrevious": "上一页",
                "sNext": "下一页",
                "sLast": "末页"
            }
        }
});
/*申请表单*/
$("tbody").on('click','.applybtn',function(){
    var project_name = $(this).attr('data')
    $('#project_name').val(project_name)
    $('#applyModal').modal('show')
})
</script>
{% endblock %}
